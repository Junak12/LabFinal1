#MEDIAN STRING
def hamming_distance(a, b):
    cnt = 0
    for i in range(len(a)):
        if a[i] != b[i]:
            cnt += 1
    return cnt


def generate_kmers(k):
    letters = ['A', 'C', 'G', 'T']
    kmers = []

    def build(curr):
        if len(curr) == k:
            kmers.append(curr)
            return
        for c in letters:
            build(curr + c)

    build("")
    return kmers


def distance_to_sequence(pattern, seq):
    k = len(pattern)
    best = 10**9
    for i in range(len(seq) - k + 1):
        window = seq[i:i+k]
        d = hamming_distance(pattern, window)
        if d < best:
            best = d
    return best


def total_distance(pattern, dna_list):
    total = 0
    for seq in dna_list:
        total += distance_to_sequence(pattern, seq)
    return total


def median_string(dna_list, k):
    all_kmers = generate_kmers(k)
    best_pattern = ""
    best_score = 10**18

    for pattern in all_kmers:
        score = total_distance(pattern, dna_list)
        if score < best_score:
            best_score = score
            best_pattern = pattern

    return best_pattern, best_score




k = int(input("Enter k: "))
n = int(input("Enter number of DNA strings: "))

dna_list = []
print("Enter the DNA strings:")
for _ in range(n):
    dna_list.append(input().strip())

result, score = median_string(dna_list, k)

print("Median String =", result)
print("Score =", score)
